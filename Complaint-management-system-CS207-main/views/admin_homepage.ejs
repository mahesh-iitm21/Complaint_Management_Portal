<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>

    <title>CPMS</title>

    <style>
        html,
        body {
            min-height: 100%;
        }



        h1 {
            margin: 15px 0;
            margin-top: 60px;

        }

        h4 {
            margin-bottom: 4px;
        }

        .testbox {
            display: flex;
            justify-content: center;
            align-items: center;
            height: inherit;
            padding: 3px;
        }







        textarea {
            margin-bottom: 3px;
        }

        .item {
            position: relative;
            display: flex;
            flex-direction: column;
            margin: 10px 0;
        }

        input[type="date"]::-webkit-inner-spin-button {
            display: none;
        }

        .item i,
        input[type="date"]::-webkit-calendar-picker-indicator {
            position: absolute;
            font-size: 20px;
            color: #a9a9a9;
        }

        .item i {
            left: 94%;
            top: 30px;
            z-index: 1;
        }

        [type="date"]::-webkit-calendar-picker-indicator {
            left: 93%;
            z-index: 2;
            opacity: 0;
            cursor: pointer;
        }

        .street,
        .desired-outcome-item,
        .complaint-details-item {
            display: flex;
            flex-wrap: wrap;
        }

        .street input {
            margin-bottom: 10px;
        }

        small {
            display: block;
            line-height: 16px;
            opacity: 0.7;
        }

        .btn-block {
            margin-top: 20px;
            text-align: center;
        }

        button {
            width: 150px;
            padding: 10px;
            border: none;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            background-color: green;
            font-size: 16px;
            color: #fff;
            cursor: pointer;
        }

        button:hover {
            background-color: greenyellow;
            color: black;
        }

        @media (min-width: 568px) {


            .item {
                flex-direction: row;
                align-items: center;
            }

            .item p {
                width: 30%;
            }

            .item i {
                left: 61%;
                top: 25%;
            }

            [type="date"]::-webkit-calendar-picker-indicator {
                left: 60%;
            }

            .street,
            .desired-outcome-item,
            .complaint-details-item {
                width: 70%;
            }



            .street .street-item {
                width: 100%;
            }

            .address p,
            .desired-outcome p,
            .complaint-details p {
                align-self: flex-start;
                margin-top: 6px;
            }

            .desired-outcome-item,
            .complaint-details-item {
                margin-left: 12px;
            }

            textarea {
                width: calc(100% - 6px);
            }
        }

        :root {
            --color-primary: #0073ff;
            --color-white: #e9e9e9;
            --color-black: #141d28;
            --color-black-1: #212b38;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: sans-serif;

        }

        .logo {
            color: var(--color-white);
            font-size: 30px;
        }

        .logo span {
            color: var(--color-primary);
        }

        .menu-bar {
            background-color: var(--color-black);
            height: 80px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5%;
            position: fixed;
            top: 0;
        }

        .menu-bar ul {
            list-style: none;
            display: flex;
        }

        .menu-bar ul li {
            /* width: 120px; */
            padding: 10px 30px;
            /* text-align: center; */

            position: relative;
        }

        .menu-bar ul li a {
            font-size: 20px;
            color: var(--color-white);
            text-decoration: none;

            transition: all 0.3s;
        }

        .menu-bar ul li a:hover {
            color: var(--color-primary);
        }





        input[type=text] {
            width: 100%;
            padding: 12px 20px;
            box-sizing: content-box;
        }

        #un {

            margin-bottom: 10px;
            border: 2px solid black;
            border-radius: 5px;
            padding: 5px;
        }

        #sub {
            padding: 5px;
            border: 2px solid black;
            border-radius: 5px;

        }
    </style>

</head>

<body>
    <div class="menu-bar" style="z-index: 2;">
        <h2 class="logo">CP<span>MS</span></h2>
        <ul>

            <li><a href="/admin/logout">Logout</a></li>
        </ul>
    </div>
    <div class="card" style="margin-top: 60px;">
        <div class="card-body mx-4">
            <div class="container">
                <%var k=1%>
                    <p class="my-5" style="font-size: 30px;">Complaints</p>
                    <%for( i of complaints){%>
                        <div class="row">
                            <ul class="list-unstyled">
                                <li class="text-muted mt-1"><span class="text-black">Complaint</span>#<%=k%>
                                        <% k++ %>
                                </li>
                                <li class="text-black mt-1">Date: <%= i.createdAt.toString().substring(3,15) %> <br>
                                        Time: <%= i.createdAt.toString().substring(15,21) %>
                                </li>
                            </ul>
                            <hr>
                            <div class="col-xl-9">
                                <p>Complaint Category</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.category%>
                                </p>
                            </div>
                            <hr>
                        </div>
                        <div class="row">
                            <div class="col-xl-9">
                                <p>Complaint Subject</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.subject%>
                                </p>
                            </div>
                            <hr>
                        </div>
                        <div class="row">
                            <div class="col-xl-9">
                                <p>Complaint Description</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.desc%>
                                </p>
                            </div>
                            <hr>
                        </div>
                        <div class="row">
                            <div class="col-xl-9">
                                <p>Name</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.name%>
                                </p>
                            </div>
                            <div class="col-xl-9">
                                <p>Roll no</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.roll%>
                                </p>
                            </div>
                            <div class="col-xl-9">
                                <p>Hostel</p>
                            </div>
                            <div class="col-xl-3">
                                <p>
                                    <%=i.campus%> -> <%=i.block%> -> <%=i.hostel%>
                                </p>
                            </div>

                            <hr>
                        </div>

                        <form action="/admin/update/<%= i._id %>" method="POST">

                            <div class="row">
                                <div class="col-xl-9">
                                    <p>Admin's Response</p>
                                </div>
                                <div class="col-xl-3">
                                    <p>
                                        <%if(i.status=="Unresolved"){%>
                                            <input type="text" id="fname" name="resp"><br><br>
                                            <% } else{ %>
                                                <%= i.resp %>
                                    </p>
                                    <%} %>
                                </div>
                                <hr>
                            </div>


                            <%if(i.status=="Unresolved"){%>
                                <select name="status" id="un">
                                    <option value="Unresolved">Unresolved</option>
                                    <option value="Resolved">Resolved</option>
                                </select>
                                <br>
                                <input type="submit" value="Submit" id="sub">
                                <% } else{ %>
                                    <button type="button" class="btn btn-success">
                                        <%=i.status%>
                                    </button>
                                    <%} %>
                                        <br><br>

                        </form><br><br>
                        <%} %>

            </div>



        </div>
    </div>
</body>

</html>